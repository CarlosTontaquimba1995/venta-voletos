<div class="seat-selection-container">
    <h2>Selecciona tu tipo de localidad</h2>
    <div class="seat-cards">
        <mat-card *ngFor="let seatType of seatTypes" [class.selected]="selectedSeatType?.id === seatType.id"
            [class.unavailable]="!seatType.available" (click)="onSeatSelect(seatType)"
            [matTooltip]="!seatType.available ? 'Agotado' : ''" matTooltipPosition="above"
            [class.best-value]="seatType.id === 'preferente'" [@fadeIn]>
            <div class="card-badge" *ngIf="seatType.id === 'preferente'">Mejor oferta</div>

            <mat-card-header>
                <mat-card-title>
                    <mat-icon *ngIf="seatType.id === 'vip'" class="card-icon">star</mat-icon>
                    <mat-icon *ngIf="seatType.id === 'preferente'" class="card-icon">favorite</mat-icon>
                    <mat-icon *ngIf="seatType.id === 'general'" class="card-icon">event_seat</mat-icon>
                    {{seatType.name}}
                </mat-card-title>
                <mat-card-subtitle>
                    <span class="price">${{seatType.price}} USD</span>
                    <span class="taxes">+ impuestos</span>
                </mat-card-subtitle>
            </mat-card-header>

            <div *ngIf="selectedSeatType?.id === seatType.id" class="quantity-controls">
                <div class="quantity-label">Cantidad:</div>
                <div class="quantity-selector">
                    <button mat-icon-button (click)="decrementQuantity(); $event.stopPropagation()" [disabled]="quantity <= 0">
                        <span class="quantity-btn">-</span>
                    </button>
                    <span class="quantity">{{quantity}}</span>
                    <button mat-icon-button (click)="incrementQuantity(); $event.stopPropagation()" [disabled]="quantity >= 10">
                        <span class="quantity-btn">+</span>
                    </button>
                </div>
            </div>
        </mat-card>
    </div>

    <div class="selection-summary fade-in">
        <h3>Resumen de tu selecci√≥n</h3>
        <div class="selection-details">
            <ng-container *ngFor="let seatType of seatTypes">
                <ng-container *ngIf="seatQuantities[seatType.id] as seatData">
                    <div class="detail-row" *ngIf="seatData.quantity > 0">
                        <span class="detail-label">
                            {{ seatData.quantity }} x {{ seatType.name }}
                        </span>
                        <span class="detail-value">
                            ${{ seatType.price * seatData.quantity }} USD
                        </span>
                    </div>
                </ng-container>
            </ng-container>
            <div class="detail-row total" *ngIf="getTotalPrice() > 0">
                <span class="detail-label">Total a pagar</span>
                <span class="detail-value">${{getTotalPrice()}} USD</span>
            </div>
        </div>
    </div>
</div>